# 基于深度学习的癌症分类模型研究

## 第一章

### 1.1 课题意义

#### 1.1.1 癌症治疗的研究现状及癌症基因组学

癌症作为一个重要的健康问题，在发达国家中已经成为了第二大致死病因，其致病原因主要与老龄化和人们生活习惯密切相关。
对于癌症治疗，早期诊断、全球性的医疗帮助和癌症疗法的发展都使得癌症病人的存活率显著的提升， 如今，患有各种不同癌症的病人有接近三分之二能够得以最终治愈。
在癌症传统的治疗手段中，手术切除是一种针对局部肿瘤的有效治疗方法，而20世纪20年代的出现的放射治疗和40年代出现的化学治疗等多种手段使得癌症治疗的方式更多样、更有效。[11]

另一方面，科学家们提出了癌症基因组学的理论，开始了从DNA遗传序列突变的角度对癌症发病机理进行研究。
在癌症基因组学的理论中，癌症细胞中的DNA遗传序列的细微改变会导致细胞产生蛋白质不能正常地工作， 这些蛋白质会使得细胞极其迅速地生长，并且对邻近的细胞造成伤害，从而损害人类的生理机能，导致疾病的产生。
通过研究这些癌症基因突变，科学家们可以发现DNA序列中的哪些变化对应了哪些癌症细胞的变化，有助于识别同一癌症的不同子型（如HER2+的乳腺癌子型）和针对患者提供最有效的个性化治疗。
随着人类基因组计划的进行，科学家们开始从基因组突变的层面上去研究癌症的发病机理、指导癌症治疗药物的研发，癌症基因组学正成为癌症治疗研究的主流方向。

#### 1.1.2 基因组测序技术的发展及对癌症治疗研究的意义

在过去几年中，DNA测序技术的发展使得基因组研究领域发生了革命性的改变，快速且低成本地产生大量的测序数据变得可行。
通过使用当前的高通测序设备，过去人类基因组计划[]用了超过13年的时间、耗费百万美元所获得的测序数据，如今只需用费数万美元、在几周之内即可获得。
测序成本的大幅降低意味着更多的研究者可以获取到DNA测序数据，促使癌症基因组学的蓬勃发展。
面对海量的DNA测序数据，科学家们采用各种统计归纳和机器学习的算法进行数据挖掘，从单基因研究的角度逐步扩展到多基因乃至全基因组的全局研究，
在更高层次上挖掘不同癌症的深层致病模式，对癌症基因组的研究产生了深远的影响。[3]

#### 1.1.3 癌症分类模型及致病机理研究

癌症分类是癌症基因组测序数据的一个重要应用。
癌症分类模型混合使用了多种DNA测序数据， 其中包括基因突变数据（Mutant)，拷贝数变化（Copy Number），DNA甲基化（DNA Methylation）等。
模型针对不同的数据类型分别进行合理的预处理，将病人对应的经过预处理的测序数据输入到模型中训练调整模型参数，反复训练以得到合理的分类结果。
通过基于海量癌症病人的DNA测序数据构造出的分类系统，可根据测试者DNA测序数据给出其患各种癌症的概率预测，对癌症患病作出智能评估，为癌症早期诊断数据支撑。

另一方面，在最近几年，很多癌症测序研究的论文得出了不同癌症产生其重要作用的驱动基因（Driver Gene），这些驱动基因的突变率明显的高于被动基因（Passenger Gene），
并且往往在蛋白质作用变化中起主要作用。[6]
因此，根据测序数据进行分析，构造统计归纳模型，寻找各种癌症的致病关键的驱动基因以及不同癌症间共有的致病模式，正逐渐成为科学家们对癌症研究的新方向。

### 1.2 相关研究

针对癌症构造的分类模型在国内外都有了许多尝试，包括有监督分类对其进行预测和无监督聚类的癌症共性挖掘，以下是一些国内外已有的论文结果：

#### 1.2.1 基于LDA算法的癌症分类模型

Alok[9]使用了基因微阵列表达（Microarray gene expression）数据，采用Gridient LDA（Linear discriminant analysis）算法进行基于特征提取的维度下降，
避免了原始LDA算法由于小样本数量（SSS，small sample size）导致的类间散点矩阵的奇异性问题，然后利用降低后的维度进行KNN（K-nearest neighbour）算法分类，
最终对比其他之前的分类模型达到了更低的分类错误率。

Alok的GLDA算法优势在于进行了合理的维度下降，使得在病人样本数量较少的情况下，高维度的基因微阵列表达数据仍能输入到模型中进行训练，结合KNN算法构造出性能较优的分类模型。
另一方面，由于深度学习和神经网络算法的快速发展，在最终基于降维数据的分类模型的选择上，神经网络会比KNN有更有的性能。

#### 1.2.2 基于细胞表型的大肠癌分类系统

Anguraj[10]分析了1290个大肠癌（CRC，Colorectal cancer）病人的基因表达数据和治疗反应，使用了一致性的无监督聚类算法，将临床表型相关的CRC病人根据算法归类。
Anguraj最终根据分类结果定义了6个临床相关的CRC子型，每一个子型都有一些基因和细胞变化层面上的相似性,每个CRC子型的基因标志是作为定义CRC子型的依据。
其中三个子型的病人在治愈后都有较少的复发率，表明这些病人在化疗治疗的过程中收到的化疗副作用较少。

Anguraj的工作很好地结合了临床治疗数据和基因突变数据，通过无监督的聚类算法，合理地分出了CRC的6种子型，对于CRC的治疗和研究都提供了很好的指导作用。

#### 1.2.3 12种主要癌症基因突变全局分析

Cyriac[12]利用TCGA计划中的3281个患有12中不同癌症病人的点突变和DNA序列的增删数据，展示了各种癌症的突变频率分布，建立它们到细胞组织的联系、细胞环境的影响和DNA修复的缺陷等。
使用这些整合数据，Cyriac从熟悉的癌症细胞过程基因中识别出127个主要的突变基因，不同癌症类型在这127个主要基因的突变频率各不相同，
大部分的癌症只对应了2到6个突变基因，但其中包含了对癌症起重要作用的驱动基因。
临床的相关数据表明基因突变对于病人的生存率有重要的影响，基因克隆和子克隆影响了DNA序列的排布，从而导致肿瘤的产生。

Cyriac主要的分析方法是频率统计，对所有12中癌症都作出了很好的归纳和分析，并且能够将分析得出的重要基因与其对应的生理过程对应起来，
深层次地揭示癌症产生的原因，这些结果对于新的癌症诊断和个性化癌症治疗都有着重要的意义。

#### 1.2.4 基于基因表达秩序关系识别癌症预后与早期诊断标志

章琳[7]提出了基于基因表达秩序关系的CTSP预测算法，可用于乳腺癌预后的预测及肝癌的早期诊断。
CTSP算法一方面以秩序关系作为表示值较为稳定，能够减少由于每个样本由于检测条件差异或线性片间标准化的影响，
另一方面，以大量的对照组作为基准，可以识别出仅在部分观察组样本中出现的基因表达秩序关系。

章琳的算法主要立足于病人临床的体征数据，针对与乳腺癌和肝癌的早期诊断和预后判别都提供很很好的支持，
然而，仅在临床数据上的研究始终难以还原整个致病的脉络，缺乏对于致病机理的深入挖掘。

#### 1.2.5 基于支持向量机算法的癌症预测

吴疆[8]使用了来自美国癌症研究中心的253个卵巢癌质谱数据样本，将其随机划分为168个训练样本和85个验证样本，数据维度是15154维。
吴疆将支持向量机的算法用于卵巢癌质谱数据分类研究上，对卵巢癌和非卵巢癌数据进行二值判别，
预测正确率达到了98%，超过了KNN和神经网络算法。

吴疆的算法是对SVM算法的合理尝试，然而卵巢癌数据本身的样本数量较少导致了KNN和神经网络算法的先天劣势，
而SVM算法对于二值分类的显著性能使其超过了同类算法，因此吴疆可以进一步扩展样本数量再进行模型对比。

### 1.3 课题背景

#### 1.3.1 TCGA计划

TCGA（The Cancer Genome Atlas）计划是在2006年作为一个试点计划提出，由美国癌症研究中心（NCI，National Cancer Institute）和
美国国家人类基因组研究中心（NHGRI，National Human Genome Research Institute）联合投资5千万美元进行。
TCGA计划保证能够为每一个指定癌症创建一个变化图谱，它使得美国国内工作在独立而相关项目的研究技术团队可以展示他们的工作结果，创建了一个癌症研究的基础平台。
更重要的是TCGA计划的癌症病人数据可以供全世界的科研人员免费访问，极大促进癌症研究的发展。
TCGA计划的成功使得美国国家健康研究中心对此计划投入了大量的资源，获取到的癌症病人病人的类型超过了20种。

到2015年，TCGA研究网络计划已经实现了分析10000个患有25中不同癌症的抽样病人的基因层面上、遗传层面上和基因表达层面上的谱分析。
另一方面，TCGA也致力于提升新技术的发展和应用，去发现特定癌症的分子变异，去创造数据和分析结果用于免费提供给科学研究社区，去开发工具和标准的处理流程支持大规模的测序分析项目。
到2013年7月24日，TCGA已经映射了超过7992种表达27种癌症类型的分子模式，这些数据和工具都可以通过在http://www.cancergenome.nih.gov/上免费获取。

#### 1.3.2 国内癌症研究的发展

近几年来，中国癌症研究可谓突飞猛进。在欧美政府科研投入增长势头放缓的情况下，中国投入力度却在日渐加强。中国有巨大的需求和丰富的临床资源，在癌症研究方面有引领的潜力，
中国癌症研究在基础科研领域，新一代科学家能力进一步提升。
对于国内的癌症研究发展，在基因组学方面，华大基因等研究所已形成优势领域；在肿瘤免疫学方面，国内外科学家如华裔科学家王晓东在细胞凋亡、代谢，中国医学科学院院长曹雪涛在肿瘤免疫等方面都颇有建树。
在中国，癌症基因组学研究的发展可以依托国内丰富的临床数据资源，引入国外先进的测序设备，参考前沿的研究手段，国内的科学研究者将能研究出更多符合中国国情的癌症治疗方法和技术。


#### 1.3.3 深度学习算法的发展

要大规模分析基因组测序数据，需要用到合适的分析算法才能得到合理的结果，挖掘数据本身隐藏的信息和价值。

深度学习是机器学习的一个新的领域，也称为层次化学习算法（hierarchical learning），是一组尝试对数据进行高层次抽象建模的算法，通过使用多层的非线性转换进行组合。
深度学习是基于学习数据表现的机器学习算法中的一种一个方向，能够使数据更加容易的适应各种方向的学习训练。
各种各样的机器学习架构比如深层神经网络（deep neural network）、深层卷积神经网络（convolutional deep neural network）、
深度置信网络（deep belief network）等都已经被广泛应用于如计算机视觉、自动语音识别、自然语言处理、音乐音频信号识别等多个领域，并且都已经取得了该领域中最高水平的结果。
同时，深度学习算法需要大规模的训练样本来提取隐藏与数据之中的表现特点，因此对于庞大的基因组测序数据和TCGA的分析数据，深度学习算法是合理选择[7]。

### 1.4 课题内容概述

本课题主要是利用TCGA的基因组突变序列数据，结合多种深度学习和神经网络算法，提取针对癌症的基因层面上的特征，构造根据肿瘤病人突变序列判别癌症类型的癌症预测模型，
同时深入挖掘模型参数，结合各种统计归纳的算法，找出模型中隐藏的不同癌症共有的致病基因模式，以此归纳出新的癌症子型。本课题的主要工作分为以下三点：

1. 构建基于深度学习的神经网络算法的癌症分类模型，能针对癌症突变序列进行癌症分类预测；
2. 测试模型的分类性能，对比不同的分类模型进行交叉验证；
3. 使用基于深度学习的无监督聚类技术分析分类模型的隐藏节点，归纳出不同癌症的致病基因模式；

本课题使用的主要算法是深度学习和神经网络算法中的一些基本算法和变种算法，以及不同算法的组合，
包括受限玻尔兹曼机（RBM）、多层神经网络（MLP）、分类的受限玻尔兹曼机（Classification RBM）和深度置信网络（Deep Belief Network）等算法。
本课题核心算法代码主要由C++编写，运行Linux系统，使用R语言进行数据预处理和数据分析，使用Intel MKL数学运算库进行矩阵运算的加速。


## 参考文献

1. Genome sequencing in microfabricated high-density picolitre reactors
2. Cancer genome sequencing: a review
3. Understanding and improving high-throughput sequencing data production and analysis
4. Cancer risk prediction models: a workshop on development, evaluation, and application
5. History of Cancer, Ancient and Modern Treatment Methods
6. Identifying cancer driver genes in tumor genome sequencing studies.
7. 基于基因表达秩序关系识别癌症预后与早期诊断标志
8. 基于支持向量机算法的癌症预测
9. Cancer classification by gradient LDA technique using microarray gene expression data
10. A colorectal cancer classification system that associates cellular phenotype and responses to therapy
11. Recent Advances in Cancer Therapy: An Overview
12. Mutational landscape and significance across 12 major cancer types

## 关键词
`癌症早诊早治项目`
